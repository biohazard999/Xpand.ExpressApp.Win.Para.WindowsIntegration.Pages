<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Xpand.ExpressApp.Win.Para.WindowsIntegration : " />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Xpand.ExpressApp.Win.Para.WindowsIntegration</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/biohazard999/Xpand.ExpressApp.Win.Para.WindowsIntegration.Pages">View on GitHub</a>

          <h1 id="project_title">Xpand.ExpressApp.Win.Para.WindowsIntegration</h1>
          <h2 id="project_tagline"></h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/biohazard999/Xpand.ExpressApp.Win.Para.WindowsIntegration.Pages/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/biohazard999/Xpand.ExpressApp.Win.Para.WindowsIntegration.Pages/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a name="xpandexpressappwinparawindowsintegration" class="anchor" href="#xpandexpressappwinparawindowsintegration"><span class="octicon octicon-link"></span></a>Xpand.ExpressApp.Win.Para.WindowsIntegration</h1>

<p>Deeper Windows Integration Features to XAF/Xpand</p>

<h2>
<a name="the-windowsintegrationwindowsformsmodule" class="anchor" href="#the-windowsintegrationwindowsformsmodule"><span class="octicon octicon-link"></span></a>The WindowsIntegrationWindowsFormsModule</h2>

<p>This Module allows you to integrate the <a href="http://documentation.devexpress.com/#WindowsForms/clsDevExpressUtilsTaskbarTaskbarAssistanttopic" title="TaskbarAssistent Component">TaskbarAssistent</a> into XAF.</p>

<h3>
<a name="installation" class="anchor" href="#installation"><span class="octicon octicon-link"></span></a>Installation</h3>

<p>Simple grab via nuget or download the source and rebuild it. If you build it from scratch you need to specify a key for strong naming.</p>

<pre><code>Install-Package Xpand.ExpressApp.Win.Para.WindowsIntegration
</code></pre>

<h3>
<a name="getting-started" class="anchor" href="#getting-started"><span class="octicon octicon-link"></span></a>Getting started</h3>

<p>Integrate the <code>WindowsIntegrationWindowsFormsModule</code> like you would do with any Module.
This is a WindowsForms only Module.</p>

<p>Rebuild your project and you will see 2 additional nodes in the Options section:</p>

<p><img src="http://i.imgur.com/vur7hpM.png" alt=""></p>

<p>The <code>TaskbarJumpListOptions</code> node allows you to specify <code>JumplistCategories</code> and <code>JumplistItems</code>. </p>

<h3>
<a name="jumplists" class="anchor" href="#jumplists"><span class="octicon octicon-link"></span></a>Jumplists</h3>

<p>Set the <code>EnableJumplist</code> option to <code>True</code> and specify a argument name that will be used to launch your application with command line arguments.</p>

<p><img src="http://i.imgur.com/EsCmOa4.png" alt=""></p>

<blockquote>
<p>Note if you only like to launch external applications you can skip the <code>NavigationItemJumplistArgumentName</code>
The <code>NavigationItemJumplistArgumentName</code> should end with a <strong>colon</strong>.</p>
</blockquote>

<p>You see two nodes:</p>

<ol>
<li>The <code>CustomCategories</code> node: This allows you to specify custom categories with <code>JumpItems</code> in it.</li>
<li>The <code>TasksCategory</code> is the default category provided by windows.</li>
</ol><p><img src="http://i.imgur.com/CjcAtQ1.png" alt=""></p>

<p>Currently there are 3 types of <code>JumpListItems</code>:</p>

<ol>
<li>The <code>TaskbarJumplistJumpItemLaunch</code> allows you to specify any program that you'd like to launch. You can provide arguments and a <code>WorkingDirectory</code>.</li>
<li>The <code>TaskbarJumplistJumpItemNavigationItem</code> allows you to specify a <code>NavigationItem</code> the user can select from the the Jumplist.</li>
<li>The <code>TaskbarJumplistSeperatorItem</code> is a simple seperator that draws a horizontal line.</li>
</ol><p><img src="http://i.imgur.com/sJtdh5W.png" alt=""></p>

<h4>
<a name="taskbarjumplistjumpitemlaunch" class="anchor" href="#taskbarjumplistjumpitemlaunch"><span class="octicon octicon-link"></span></a>TaskbarJumplistJumpItemLaunch</h4>

<p><img src="http://i.imgur.com/QSAoYJY.png" alt=""></p>

<p>You can currently specify:</p>

<ul>
<li>
<code>PathToLaunch</code>: The program you like to launch</li>
<li>
<code>Arguments</code>: The arguments that are passed to the application</li>
<li>
<code>WorkingDirectory</code>: Specifies the folder in which the program is launched</li>
<li>
<code>ImageName</code>: An <a href="#Images">ImageName</a> to provide an icon for the JumpListItem</li>
<li>
<code>Caption</code>: The Text that is displayed to the user</li>
<li>
<code>Index</code>: The order of the JumpListItem</li>
<li>
<code>Id</code>: The Id of the item</li>
</ul><h4>
<a name="taskbarjumplistjumpitemnavigationitem" class="anchor" href="#taskbarjumplistjumpitemnavigationitem"><span class="octicon octicon-link"></span></a>TaskbarJumplistJumpItemNavigationItem</h4>

<p><img src="http://i.imgur.com/q4XDmM7.png" alt=""></p>

<p>You can currently specify:</p>

<ul>
<li>
<code>NavigationItem</code>: Specifies the NavigationItem that should be shown</li>
<li>
<code>UseProtocolIfAvailable</code>: Uses the protocol handler if available</li>
<li>
<code>ImageName</code>: An <a href="#Images">ImageName</a> to provide an icon for the JumpListItem </li>
<li>
<code>Caption</code>: The Text that is displayed to the user</li>
<li>
<code>Index</code>: The order of the JumpListItem</li>
<li>
<code>Id</code>: The Id of the item</li>
</ul><h4>
<a name="taskbarjumplistseperatoritem" class="anchor" href="#taskbarjumplistseperatoritem"><span class="octicon octicon-link"></span></a>TaskbarJumplistSeperatorItem</h4>

<p><img src="http://i.imgur.com/zOAhFkd.png" alt=""></p>

<p>You can currently specify:</p>

<ul>
<li>
<code>Index</code>: The order of the JumpListItem</li>
<li>
<code>Id</code>: The Id of the item</li>
</ul><h4>
<a name="custom-categories" class="anchor" href="#custom-categories"><span class="octicon octicon-link"></span></a>Custom Categories</h4>

<p><img src="http://i.imgur.com/4pUwdBX.png" alt=""></p>

<p><img src="http://i.imgur.com/bVMs33r.png" alt=""></p>

<p>You can currently specify:</p>

<ul>
<li>
<code>Caption</code>: The caption of the Category</li>
<li>
<code>Index</code>: The order of the JumpListItem</li>
<li>
<code>Id</code>: The Id of the item</li>
</ul><p>Adding new items is exact the same as for the <code>TasksCategory</code>.</p>

<h3>
<a name="bootstrapping-code-for-navigationitemjumplistitems" class="anchor" href="#bootstrapping-code-for-navigationitemjumplistitems"><span class="octicon octicon-link"></span></a>Bootstrapping code for NavigationItemJumplistItems</h3>

<pre><code>static class Program
{
    private static WinApplication _Application;

    /// &lt;summary&gt;
    /// The main entry point for the application.
    /// &lt;/summary&gt;
    [STAThread]
    static void Main()
    {
        var assemblyName = typeof(Program).Assembly.GetName();
        var mutexName = assemblyName.Name + "_" + assemblyName.Version.ToString(3);

#if DEBUG
        mutexName += "_Debug";
#endif
        using (var instance = new SingleInstance(mutexName))
        {
            if (instance.IsFirstInstance)
            {
                instance.ArgumentsReceived += WindowsIntegrationWindowsFormsModule.InstanceOnArgumentsReceived;

                instance.ListenForArgumentsFromSuccessiveInstances();
</code></pre>

<p>Specify a mutex name. This is an ordinary string, my experiance has shown that a combination of the assemblyName combined with the version of the application and a debug constant works very well for the most scenarios.</p>

<p>Create an instance of the <code>SingleInstance</code> class that manages our application instances.
Check if this is the first instance launched, attach the <code>ArgumentsReceived</code> event handler to the <code>WindowsIntegrationWindowsFormsModule.InstanceOnArgumentsReceived</code> method and call the <code>ListenForArgumentsFromSuccessiveInstances</code> method to listen for new arguments on the <code>NamedPipe</code>.</p>

<p>Create your application as you always would:</p>

<pre><code>Application.EnableVisualStyles();
Application.SetCompatibleTextRenderingDefault(false);

_Application = new WinApplication
{
    ApplicationName = assemblyName.Name,
    SplashScreen = new DevExpress.ExpressApp.Win.Utils.DXSplashScreen()
};

_Application.CreateCustomObjectSpaceProvider += (sender, args) =&gt;
{
    args.ObjectSpaceProvider = new XPObjectSpaceProvider(new ConnectionStringDataStoreProvider(args.ConnectionString));
};

_Application.DatabaseVersionMismatch += (sender, args) =&gt;
{
    args.Updater.Update();
    args.Handled = true;
};

_Application.Modules.Add(new SystemModule());
_Application.Modules.Add(new SystemWindowsFormsModule());
_Application.Modules.Add(new WindowsIntegrationWindowsFormsModule());
_Application.Modules.Add(new DemoCenterModule());
_Application.Modules.Add(new DemoCenterWindowsFormsModule());
</code></pre>

<p><strong>Before</strong> you start the application make sure you pass the <code>WinApplication</code> instance to the <code>WindowsIntegrationWindowsFormsModule.TaskbarApplication</code> propety:</p>

<pre><code>WindowsIntegrationWindowsFormsModule.TaskbarApplication = _Application;
</code></pre>

<p>Than setup and launch your application</p>

<pre><code>InMemoryDataStoreProvider.Register();
_Application.ConnectionString = InMemoryDataStoreProvider.ConnectionString;

try
{
    _Application.Setup();

    _Application.Start();
}
catch (Exception e)
{
    _Application.HandleException(e);
}
</code></pre>

<p>If the application is <strong>not</strong> the first instance pass the arguments to the first instance:</p>

<pre><code>}
else
{
    instance.PassArgumentsToFirstInstance();
}
</code></pre>

<p>The whole bootstrapper now should look like this:</p>

<pre><code>using System;
using System.Configuration;
using System.Windows.Forms;
using DevExpress.ExpressApp.SystemModule;
using DevExpress.ExpressApp.Win;
using DevExpress.ExpressApp.Win.SystemModule;
using DevExpress.ExpressApp.Xpo;
using Xpand.Demo.Para.DemoCenter.Module.Win;
using Xpand.ExpressApp.Win.Para.WindowsIntegration;

namespace Xpand.Demo.Para.DemoCenter.Win
{
    static class Program
    {
        private static WinApplication _Application;

        /// &lt;summary&gt;
        /// The main entry point for the application.
        /// &lt;/summary&gt;
        [STAThread]
        static void Main()
        {
            var assemblyName = typeof(Program).Assembly.GetName();
            var mutexName = assemblyName.Name + "_" + assemblyName.Version.ToString(3);

#if DEBUG
            mutexName += "_Debug";
#endif
            using (var instance = new SingleInstance(mutexName))
            {
                if (instance.IsFirstInstance)
                {
                    instance.ArgumentsReceived += WindowsIntegrationWindowsFormsModule.InstanceOnArgumentsReceived;

                    instance.ListenForArgumentsFromSuccessiveInstances();

                    Application.EnableVisualStyles();
                    Application.SetCompatibleTextRenderingDefault(false);

                    _Application = new WinApplication
                    {
                        ApplicationName = assemblyName.Name,
                        SplashScreen = new DevExpress.ExpressApp.Win.Utils.DXSplashScreen()
                    };

                    _Application.CreateCustomObjectSpaceProvider += (sender, args) =&gt;
                    {
                        args.ObjectSpaceProvider = new XPObjectSpaceProvider(new ConnectionStringDataStoreProvider(args.ConnectionString));
                    };

                    _Application.DatabaseVersionMismatch += (sender, args) =&gt;
                    {
                        args.Updater.Update();
                        args.Handled = true;
                    };

                    _Application.Modules.Add(new SystemModule());
                    _Application.Modules.Add(new SystemWindowsFormsModule());
                    _Application.Modules.Add(new WindowsIntegrationWindowsFormsModule());
                    _Application.Modules.Add(new DemoCenterModule());
                    _Application.Modules.Add(new DemoCenterWindowsFormsModule());

                    WindowsIntegrationWindowsFormsModule.TaskbarApplication = _Application;

                    InMemoryDataStoreProvider.Register();
                    _Application.ConnectionString = InMemoryDataStoreProvider.ConnectionString;

                    try
                    {
                        _Application.Setup();

                        _Application.Start();
                    }
                    catch (Exception e)
                    {
                        _Application.HandleException(e);
                    }
                }
                else
                {
                    instance.PassArgumentsToFirstInstance();
                }
            }
        }
    }
}
</code></pre>

<p>That's it!</p>

<h3>
<a name="custom-protocols" class="anchor" href="#custom-protocols"><span class="octicon octicon-link"></span></a>Custom Protocols</h3>

<p>The custom protocol options allow you to launch your application via an custom protocol. This can be handy if you like to send a link to another workstation to open the application with a specific window. You can think about this like a normal hyperlink but this works for your machine.</p>

<p>Select the CustomProtocolOptions node:</p>

<p><img src="http://i.imgur.com/rgCkl9u.png" alt=""></p>

<p>Set the <code>EnableProtocols</code> to <code>True</code> and specify a <code>ProtolName</code>. You see a demo of the protocol under the <code>ProtocolHandler</code> node.</p>

<p>You can currently specify:</p>

<ul>
<li>
<code>AutoRegisterProtols</code>: This will write the needed registry keys automatically, when the application launches</li>
<li>
<code>EnableProtocols</code>: This en/disables the whole logic for protocol handlers</li>
<li>
<code>ProtocolDescription</code>: This is a hint in the registry what this protocol does</li>
<li>
<code>ProtoclName</code>: The name of your protocol. This should not start with a number, dashes are allowed. See more under the <a href="http://msdn.microsoft.com/en-us/library/aa767914(VS.85">microsoft documentation</a>.aspx)</li>
</ul><h3>
<a name="images" class="anchor" href="#images"><span class="octicon octicon-link"></span></a>Images</h3>

<p>The Images will automatically be compiled into a new dll (based on <code>WinApplication.UserModelDifferenceFilePath</code>)
You can specify the name of the generated assembly via the <code>Options.AutomaticImageAssemblyName</code> parameter. The default leads to <code>JumplistImages.dll</code>.</p>

<p>This is necessary because windows needs a <code>NativeResource</code> assembly. This will be full automatically generated for all images used by your <code>JumplistItems</code>.</p>

<blockquote>
<p>If you launch your application, windows is sometimes caching the icons in the jumplists, so you may not see the actual image you set. After a reboot (or a windows logon/logoff) your application icon should be updated.</p>
</blockquote>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Xpand.ExpressApp.Win.Para.WindowsIntegration maintained by <a href="https://github.com/biohazard999">biohazard999</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
